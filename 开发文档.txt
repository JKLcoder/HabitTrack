# 日程挂钩目标核心逻辑

## 1. 目标与子任务
- 用户可以创建 **目标（Goal）**。  
- 每个目标下可拆分 **子任务（Task）**，包含字段：  
  - 预计时长（est_minutes）  
  - 优先级（priority）  
  - 状态（todo/doing/done）  

## 2. 时间点绑定规则（Slot）
- 在日程模板中，用户可以将某个固定时间点（如每天 20:00–21:00）绑定到某个目标。  
- 系统每天根据模板，在该时间点自动生成一条日程块（ScheduleInstance）。  

## 3. 任务池取任务
- 系统从绑定目标的任务池中，自动挑选一个 **未完成的子任务** 填入日程块。  
- 默认选择策略：  
  1. 优先级最高  
  2. 若相同，则选择最近未执行的任务  

## 4. 任务执行结果联动
- **完成日程块**：  
  - 日程块标记为 `done`  
  - 对应子任务标记为完成（或减少剩余时长）  
- **未完成日程块**：  
  - 日程块标记为 `skipped`  
  - 子任务仍保留在任务池，等待下一次分配  

## 5. 重复调度
- 系统每天都会按照模板生成新日程。  
- 未完成的子任务会在下一天同一时间点继续被安排，直到任务完成。  

## 6. 冲突处理（可选）
- 若某时间点已有任务，用户可选择：  
  - 覆盖（新的任务替换旧的）  
  - 顺延（延迟到最近空闲时间段）  
  - 跳过（不生成该日程块）  

## 7. 进度统计
- **目标进度** = 已完成子任务数 / 总子任务数  
- **日程完成率** = 完成日程块数 / 计划日程块数  
- 可按 **天 / 周** 统计执行情况
